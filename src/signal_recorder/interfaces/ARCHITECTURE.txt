â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   GRAPE Signal Recorder API Architecture                 â•‘
â•‘                          Complete Interface Definitions                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Function 1: Quality & Time_Snap Analysis (PRODUCER)                    â”‚
â”‚  Interface: QualityAnalyzedSampleProvider                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Input:  RTP packets (multicast)                                   â”‚  â”‚
â”‚  â”‚ Process: Resequencing â†’ Gap detection â†’ Time_snap â†’ Quality       â”‚  â”‚
â”‚  â”‚ Output: SampleBatch {                                             â”‚  â”‚
â”‚  â”‚           timestamp: float (UTC, time_snap corrected)             â”‚  â”‚
â”‚  â”‚           samples: np.ndarray (16 kHz IQ)                         â”‚  â”‚
â”‚  â”‚           quality: QualityInfo (completeness, gaps, grade)        â”‚  â”‚
â”‚  â”‚           time_snap: TimeSnapReference (RTPâ†”UTC anchor)           â”‚  â”‚
â”‚  â”‚         }                                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ Produces: SampleBatch
                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                â”‚                â”‚               â”‚              â”‚
        â–¼                â–¼                â–¼               â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Function 2   â”‚ â”‚  Function 3  â”‚ â”‚ Function 4  â”‚ â”‚    Function 6        â”‚
â”‚  Archive      â”‚ â”‚  Tone        â”‚ â”‚ Decimation  â”‚ â”‚    Upload            â”‚
â”‚  Writer       â”‚ â”‚  Detector    â”‚ â”‚    +        â”‚ â”‚    Queue             â”‚
â”‚               â”‚ â”‚              â”‚ â”‚ Function 5  â”‚ â”‚                      â”‚
â”‚               â”‚ â”‚              â”‚ â”‚ Digital RF  â”‚ â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                â”‚                â”‚               â–²
        â”‚                â”‚                â”‚               â”‚
        â–¼                â–¼                â–¼               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  16 kHz NPZ   â”‚ â”‚ WWV/WWVH/CHU â”‚ â”‚  10 Hz      â”‚      â”‚
â”‚  Compressed   â”‚ â”‚ Detections   â”‚ â”‚  Digital RF â”‚â”€â”€â”€â”€â”€â”€â”˜
â”‚  Archive      â”‚ â”‚              â”‚ â”‚  HDF5       â”‚ Queue for upload
â”‚               â”‚ â”‚ time_snap âœ“  â”‚ â”‚             â”‚
â”‚               â”‚ â”‚ propagation  â”‚ â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Key Data Models (Shared Across All Functions):

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SampleBatch - Primary data container                                    â”‚
â”‚   â€¢ timestamp, samples, sample_rate                                     â”‚
â”‚   â€¢ quality: QualityInfo                                                â”‚
â”‚   â€¢ time_snap: TimeSnapReference                                        â”‚
â”‚   â€¢ channel_name, frequency_hz, ssrc                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ QualityInfo - Quality metrics                                           â”‚
â”‚   â€¢ completeness_pct, gap_count, packet_loss_pct                        â”‚
â”‚   â€¢ discontinuities: List[Discontinuity]                                â”‚
â”‚   â€¢ quality_grade: A/B/C/D/F                                            â”‚
â”‚   â€¢ time_snap_established, time_snap_confidence                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TimeSnapReference - KA9Q timing anchor                                  â”‚
â”‚   â€¢ rtp_timestamp, utc_timestamp, sample_rate                           â”‚
â”‚   â€¢ source: 'wwv_verified', 'chu_verified', 'initial'                   â”‚
â”‚   â€¢ station: 'WWV', 'CHU', 'initial'                                    â”‚
â”‚   â€¢ calculate_sample_time(rtp_ts) â†’ utc_time                            â”‚
â”‚                                                                          â”‚
â”‚   Formula: utc = time_snap_utc + (rtp - time_snap_rtp) / sample_rate   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ToneDetectionResult - WWV/WWVH/CHU discrimination                       â”‚
â”‚   â€¢ station: StationType (WWV | WWVH | CHU)                             â”‚
â”‚   â€¢ frequency_hz: 1000 or 1200                                          â”‚
â”‚   â€¢ timing_error_ms, snr_db, confidence                                 â”‚
â”‚   â€¢ use_for_time_snap: bool  âš ï¸ CRITICAL                                â”‚
â”‚                                                                          â”‚
â”‚   WWV (1000 Hz):  use_for_time_snap = True  (timing reference)         â”‚
â”‚   WWVH (1200 Hz): use_for_time_snap = False (propagation study only)   â”‚
â”‚   CHU (1000 Hz):  use_for_time_snap = True  (timing reference)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Discontinuity - Gap/jump record for scientific provenance              â”‚
â”‚   â€¢ timestamp, sample_index                                             â”‚
â”‚   â€¢ discontinuity_type: GAP | RTP_RESET | SYNC_ADJUST | ...            â”‚
â”‚   â€¢ magnitude_samples, magnitude_ms                                     â”‚
â”‚   â€¢ rtp_sequence_before/after, rtp_timestamp_before/after               â”‚
â”‚   â€¢ wwv_related: bool, explanation: str                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Interface Methods Summary:

Function 1: QualityAnalyzedSampleProvider
  â€¢ get_sample_batch() â†’ SampleBatch
  â€¢ get_time_snap_reference() â†’ TimeSnapReference
  â€¢ get_discontinuities(since) â†’ List[Discontinuity]
  â€¢ get_quality_summary() â†’ QualityInfo
  â€¢ register_time_snap_update_callback(callback)

Function 2: ArchiveWriter
  â€¢ write_samples(timestamp, samples, quality, time_snap) â†’ Optional[Path]
  â€¢ add_discontinuity(discontinuity)
  â€¢ flush() â†’ Optional[Path]
  â€¢ verify_file_integrity(path) â†’ bool

Function 3: ToneDetector
  â€¢ process_samples(timestamp, samples) â†’ List[ToneDetectionResult]
  â€¢ get_differential_delay() â†’ float (WWV - WWVH)
  â€¢ set_detection_threshold(threshold)

Functions 4+5: DecimatorWriter
  â€¢ write_decimated(timestamp, samples, quality, time_snap) â†’ Optional[Path]
  â€¢ get_decimation_factor() â†’ int (1600 = 16000/10)
  â€¢ embed_quality_metadata(quality, discontinuities)
  â€¢ flush() â†’ Optional[Path]

Function 6: UploadQueue
  â€¢ queue_file(local_path, metadata, priority) â†’ task_id
  â€¢ get_task_status(task_id) â†’ UploadTask
  â€¢ get_pending_count() â†’ int
  â€¢ retry_failed_tasks() â†’ int
  â€¢ set_bandwidth_limit(kbps)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Files Created (3,022 lines total):

ğŸ“¦ src/signal_recorder/interfaces/
  â”œâ”€â”€ __init__.py (101 lines)           - Package exports
  â”œâ”€â”€ data_models.py (450 lines)        - Shared data structures
  â”œâ”€â”€ sample_provider.py (~200 lines)   - Function 1 interface
  â”œâ”€â”€ archive.py (~280 lines)           - Function 2 interface
  â”œâ”€â”€ tone_detection.py (~330 lines)    - Function 3 interface
  â”œâ”€â”€ decimation.py (~370 lines)        - Functions 4+5 interface
  â”œâ”€â”€ upload.py (~370 lines)            - Function 6 interface
  â”œâ”€â”€ README.md (600 lines)             - User guide with examples
  â””â”€â”€ API_SUMMARY.md (800 lines)        - Complete API reference

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
