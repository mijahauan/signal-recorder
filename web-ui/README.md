# GRAPE Web UI - Monitoring Dashboards

**Real-time monitoring and visualization interface for the GRAPE signal recorder.**

## âœ¨ Features

- **Real-time Monitoring** - System status, channel health, data quality
- **Carrier Analysis** - Spectrograms and Doppler visualization
- **WWV/WWVH Discrimination** - Differential delay time series
- **Timing Quality** - GPS/NTP timing status and metrics
- **Pure Presentation Layer** - No business logic, just displays data

---

## ğŸš€ Quick Start

### Prerequisites

1. **GRAPE signal recorder** installed and running
2. **Node.js 16+** and pnpm (or npm)
3. **Data being generated** by core recorder and analytics service

### Installation

```bash
cd web-ui
pnpm install  # or: npm install
```

### Starting the Web UI

**From project root** (recommended):
```bash
./start-dual-service.sh
# Starts: core recorder + analytics + web UI
```

**Manually from web-ui directory**:
```bash
./start-monitoring.sh
```

**Or directly**:
```bash
node monitoring-server-v3.js [data_root]
```

### Accessing Dashboards

**Entry point**: http://localhost:3000/ (redirects to summary)

**Active Dashboards**:
- **summary.html** - System overview, channel health, data completeness
- **carrier.html** - Carrier analysis, spectrograms, Doppler visualization
- **discrimination.html** - WWV/WWVH differential delays
- **timing-dashboard.html** - Timing quality metrics

---

## ğŸ—‚ï¸ Project Structure

```
web-ui/
â”œâ”€â”€ monitoring-server-v3.js      # â­ Production API server
â”œâ”€â”€ grape-paths.js               # Data location authority
â”‚
â”œâ”€â”€ index.html                   # Entry (redirects to summary)
â”œâ”€â”€ summary.html                 # â­ Main dashboard
â”œâ”€â”€ carrier.html                 # â­ Carrier analysis
â”œâ”€â”€ discrimination.html          # â­ WWV/WWVH discrimination
â”œâ”€â”€ timing-dashboard.html        # â­ Timing quality
â”œâ”€â”€ discrimination.js            # Chart logic
â”‚
â”œâ”€â”€ utils/                       # Server utilities
â”œâ”€â”€ middleware/                  # Express middleware
â”œâ”€â”€ scripts/                     # Admin scripts
â”œâ”€â”€ data/                        # Runtime data (users, auth)
â”‚
â”œâ”€â”€ start-monitoring.sh          # Startup scripts
â”œâ”€â”€ start-audio-proxy.sh
â”œâ”€â”€ check-dashboard-status.sh
â”‚
â”œâ”€â”€ archive/legacy-pages/        # Archived obsolete pages
â””â”€â”€ package.json
```

---

## ğŸ—ï¸ Architecture

**Design Principle**: Web UI is a **presentation layer only**.

- âœ… **Knows WHERE** data is located (via `grape-paths.js`)
- âœ… **Knows HOW** to display data effectively
- âŒ **Does NOT know WHAT** data represents scientifically
- âŒ **Does NOT know HOW** data is generated

**All business logic resides in the analytics service**, not in the presentation layer.

**See**: `WEB_UI_ARCHITECTURE.md` for complete architectural details.

---

## ğŸ› ï¸ API Endpoints

The server provides REST endpoints:

```
GET /api/v1/summary                          - All dashboard data
GET /api/v1/system/status                    - System processes
GET /api/v1/channels/status                  - Per-channel status
GET /api/v1/carrier/quality?date=YYYYMMDD    - Carrier metrics
GET /api/v1/channels/:name/discrimination/:date - Discrimination data
GET /spectrograms/:date/:dir/:file           - Spectrogram images
```

**See**: `PATHS_API_QUICK_REFERENCE.md` for complete API reference.

---

## ğŸ“Š Data Display

The web UI displays data generated by the analytics service:

### Summary Dashboard
- System status (core recorder, analytics, radiod)
- Channel health and completeness
- Data storage and upload status

### Carrier Analysis
- Spectrograms (PNG images from analytics service)
- Quality metrics (JSON from analytics service)
- Date navigation, frequency selection

### Discrimination Screen
- WWV/WWVH differential delays (CSV from analytics service)
- Time series visualization
- Statistics and trends

### Timing Dashboard
- GPS/NTP timing quality
- time_snap events
- Timing annotations

---

## ğŸš¨ Troubleshooting

### Server Won't Start
```bash
# Check if port 3000 is in use
lsof -i :3000

# Kill existing instance
pkill -f monitoring-server

# Check logs
tail -f monitoring-server.log
```

### Data Not Showing
```bash
# Verify paths are correct
node -e "const p = require('./grape-paths.js'); console.log(p.getDataRoot())"

# Check if files exist
ls -lh /path/to/data/archives/

# Check API directly
curl http://localhost:3000/api/v1/summary | jq
```

### Path Sync Issues
```bash
# Validate Python/JavaScript path consistency
cd /home/mjh/git/signal-recorder
./scripts/validate-paths-sync.sh
```

---

## ğŸ“ Documentation

- **WEB_UI_ARCHITECTURE.md** - Complete architectural documentation
- **PATHS_API_QUICK_REFERENCE.md** - API reference
- **../OPERATIONAL_SUMMARY.md** - System configuration
- **../TECHNICAL_REFERENCE.md** - Developer reference

---

**Key Takeaway**: Web UI is a **dumb display layer**. All intelligence lives in the analytics service.
