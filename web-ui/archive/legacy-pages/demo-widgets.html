<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Web-UI Widgets Demo</title>
</head>
<body style="background: #f5f5f5; padding: 20px; font-family: sans-serif;">
    <h1>New Web-UI Components - Demo Mode</h1>
    <p style="background: #fff3cd; padding: 10px; border-radius: 4px; border-left: 4px solid #ffc107;">
        ⚠️ <strong>Demo Mode:</strong> Showing sample data since analytics pipeline is not generating data yet.
    </p>
    
    <div id="timingStatus" style="margin-bottom: 20px;"></div>
    <div id="tonePowers" style="margin-bottom: 20px;"></div>
    
    <script src="components/timing-status-widget.js"></script>
    <script src="components/tone-power-display.js"></script>
    <script>
        // Mock timing status data
        const mockTimingData = {
            overall_status: 'TONE_LOCKED',
            precision_estimate_ms: 1.0,
            primary_reference: {
                channel: 'WWV 10 MHz',
                station: 'WWV',
                time_snap_rtp: 1234567890,
                time_snap_utc: new Date().toISOString(),
                source: 'TONE_DETECTED',
                confidence: 0.95,
                age_seconds: 45,
                timing_class: 'TONE_LOCKED'
            },
            channel_breakdown: {
                tone_locked: 2,
                ntp_synced: 1,
                interpolated: 0,
                wall_clock: 0
            },
            total_channels: 3,
            recent_adoptions: [
                {
                    timestamp: new Date(Date.now() - 3600000).toISOString(),
                    channel: 'WWV 10 MHz',
                    reason: 'Archive time_snap adopted',
                    improvement_ms: 2.3
                }
            ],
            last_updated: new Date().toISOString()
        };
        
        // Mock tone power data
        const mockToneData = {
            channels: [
                {
                    channel: 'WWV 10 MHz',
                    tone_1000_hz_db: 35.2,
                    tone_1200_hz_db: 28.7,
                    ratio_db: 6.5,
                    status: 'OK'
                },
                {
                    channel: 'WWV 15 MHz',
                    tone_1000_hz_db: 32.1,
                    tone_1200_hz_db: 30.4,
                    ratio_db: 1.7,
                    status: 'OK'
                }
            ],
            last_updated: new Date().toISOString()
        };
        
        // Override fetch for demo
        const originalFetch = window.fetch;
        window.fetch = function(url) {
            if (url.includes('/api/v1/timing/status')) {
                return Promise.resolve({
                    ok: true,
                    json: () => Promise.resolve(mockTimingData)
                });
            } else if (url.includes('/api/v1/tones/current')) {
                return Promise.resolve({
                    ok: true,
                    json: () => Promise.resolve(mockToneData)
                });
            }
            return originalFetch.apply(this, arguments);
        };
        
        // Initialize widgets
        const timingWidget = new TimingStatusWidget('timingStatus');
        const tonePowerDisplay = new TonePowerDisplay('tonePowers');
        
        console.log('✅ Demo widgets loaded with sample data');
    </script>
</body>
</html>
